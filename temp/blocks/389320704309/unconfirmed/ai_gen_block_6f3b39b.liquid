{% doc %}
  @prompt
    I want to build frequently asked questions section where you have on the left side a Sub heading, heading and body. on the right side should be all questions aligned vertically with a dropdown icon that once you click on it allows you to see the answer of the clicked question, include a breakpoint for mobile that turns the whole layout vertical, make the padding of the general container to behave the same way as the other sections in this theme, including the same padding, margins, I want to be able to adjust the border radius of each individual corner of the questions container, include a single input field to type the values in this format 16,16, fix the issue when hover the question container, I want to be able to set an image as background for this section or set a background color that I can also choose, now I want to be able as well to change the color of the container or set an image as background, now when you hover the questions it get a different colored shape of the container, please make the question container and and the hover of this container to have the same shape, remove the border radius of the overlay/hover container, remove the hover effect for questions, remove the overlay effect when hovering the whole container of the section

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% comment %}Parse border radius values{% endcomment %}
{% assign border_radius_values = block.settings.question_border_radius_custom | split: ',' %}
{% assign top_left = border_radius_values[0] | default: '6' | strip %}
{% assign top_right = border_radius_values[1] | default: top_left | strip %}
{% assign bottom_right = border_radius_values[2] | default: top_left | strip %}
{% assign bottom_left = border_radius_values[3] | default: top_right | strip %}

{% style %}
  .ai-faq-section-{{ ai_gen_id }} {
    padding: 60px 0;
    {% if block.settings.section_background_image %}
      background-image: url('{{ block.settings.section_background_image | image_url: width: 2000 }}');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    {% else %}
      background-color: {{ block.settings.section_background_color }};
    {% endif %}
    position: relative;
  }

  .ai-faq-section-overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: {{ block.settings.overlay_color }};
    opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }};
    pointer-events: none;
  }

  .ai-faq-container-{{ ai_gen_id }} {
    max-width: {{ settings.container_width }}px;
    margin: 0 auto;
    padding: 0 {{ settings.gutter_width }}px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: {{ block.settings.section_gap }}px;
    {% if block.settings.container_background_image %}
      background-image: url('{{ block.settings.container_background_image | image_url: width: 1500 }}');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    {% else %}
      background-color: {{ block.settings.background_color }};
    {% endif %}
    border-radius: {{ block.settings.border_radius }}px;
    padding: {{ block.settings.section_padding }}px;
    position: relative;
    z-index: 1;
  }

  .ai-faq-container-overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: {{ block.settings.container_overlay_color }};
    opacity: {{ block.settings.container_overlay_opacity | divided_by: 100.0 }};
    pointer-events: none;
    border-radius: {{ block.settings.border_radius }}px;
  }

  .ai-faq-content-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 16px;
    position: relative;
    z-index: 2;
  }

  .ai-faq-subheading-{{ ai_gen_id }} {
    color: {{ block.settings.subheading_color }};
    font-size: {{ block.settings.subheading_size }}px;
    margin: 0;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 500;
  }

  .ai-faq-heading-{{ ai_gen_id }} {
    color: {{ block.settings.heading_color }};
    font-size: {{ block.settings.heading_size }}px;
    margin: 0;
    line-height: 1.2;
    font-weight: 700;
  }

  .ai-faq-body-{{ ai_gen_id }} {
    color: {{ block.settings.body_color }};
    font-size: {{ block.settings.body_size }}px;
    line-height: 1.6;
    margin: 0;
  }

  .ai-faq-questions-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: {{ block.settings.question_gap }}px;
    position: relative;
    z-index: 2;
  }

  .ai-faq-item-{{ ai_gen_id }} {
    border: 1px solid {{ block.settings.question_border_color }};
    border-radius: {{ top_left }}px {{ top_right }}px {{ bottom_right }}px {{ bottom_left }}px;
    overflow: hidden;
    background-color: {{ block.settings.question_background }};
  }

  .ai-faq-question-button-{{ ai_gen_id }} {
    width: 100%;
    padding: {{ block.settings.question_padding }}px;
    background: transparent;
    border: none;
    text-align: left;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    color: {{ block.settings.question_color }};
    font-size: {{ block.settings.question_size }}px;
    font-weight: 600;
  }

  .ai-faq-question-text-{{ ai_gen_id }} {
    flex-grow: 1;
  }

  .ai-faq-icon-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
    transition: transform 0.3s ease;
    color: {{ block.settings.icon_color }};
    flex-shrink: 0;
  }

  .ai-faq-item-{{ ai_gen_id }}.active .ai-faq-icon-{{ ai_gen_id }} {
    transform: rotate(180deg);
  }

  .ai-faq-answer-{{ ai_gen_id }} {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease;
    background-color: {{ block.settings.answer_background }};
  }

  .ai-faq-answer-content-{{ ai_gen_id }} {
    padding: 0 {{ block.settings.question_padding }}px;
    color: {{ block.settings.answer_color }};
    font-size: {{ block.settings.answer_size }}px;
    line-height: 1.6;
  }

  .ai-faq-item-{{ ai_gen_id }}.active .ai-faq-answer-{{ ai_gen_id }} {
    max-height: 500px;
    padding: {{ block.settings.answer_padding }}px0;
  }

  @media screen and (max-width: {{ settings.lap_container_width }}px) {
    .ai-faq-container-{{ ai_gen_id }} {
      max-width: {{ settings.lap_container_width }}px;}
  }

  @media screen and (max-width: {{ settings.tab_container_width }}px) {
    .ai-faq-container-{{ ai_gen_id }} {
      max-width: {{ settings.tab_container_width }}px;
      padding: 0 {{ settings.gutter_width | times: 0.8 }}px;
    }
  }

  @media screen and (max-width: 768px) {
    .ai-faq-container-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
      gap: {{ block.settings.mobile_gap }}px;
      padding: {{ block.settings.section_padding | times: 0.8 }}px {{ settings.gutter_width | times: 0.6 }}px;
    }

    .ai-faq-content-{{ ai_gen_id }} {
      text-align: {{ block.settings.mobile_text_alignment }};
    }

    .ai-faq-subheading-{{ ai_gen_id }} {
      font-size: {{ block.settings.subheading_size | times: 0.9 }}px;
    }

    .ai-faq-heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.heading_size | times: 0.8 }}px;
    }

    .ai-faq-body-{{ ai_gen_id }} {
      font-size: {{ block.settings.body_size | times: 0.9 }}px;
    }

    .ai-faq-question-button-{{ ai_gen_id }} {
      padding: {{ block.settings.question_padding | times: 0.8 }}px;font-size: {{ block.settings.question_size | times: 0.9 }}px;
    }

    .ai-faq-answer-content-{{ ai_gen_id }} {
      padding: 0 {{ block.settings.question_padding | times: 0.8 }}px;
      font-size: {{ block.settings.answer_size | times: 0.9 }}px;
    }

    .ai-faq-item-{{ ai_gen_id }}.active .ai-faq-answer-{{ ai_gen_id }} {
      padding: {{ block.settings.answer_padding | times: 0.8 }}px 0;
    }
  }
{% endstyle %}

<section class="ai-faq-section-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  {% if block.settings.section_background_image and block.settings.overlay_opacity > 0 %}
    <div class="ai-faq-section-overlay-{{ ai_gen_id }}"></div>
  {% endif %}
  
  <faq-section-{{ ai_gen_id }} class="ai-faq-container-{{ ai_gen_id }}">
    {% if block.settings.container_background_image and block.settings.container_overlay_opacity > 0 %}
      <div class="ai-faq-container-overlay-{{ ai_gen_id }}"></div>
    {% endif %}
    
    <div class="ai-faq-content-{{ ai_gen_id }}">
      {% if block.settings.subheading != blank %}
        <h3 class="ai-faq-subheading-{{ ai_gen_id }}">{{ block.settings.subheading }}</h3>
      {% endif %}
      
      {% if block.settings.heading != blank %}
        <h2 class="ai-faq-heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
      {% endif %}
      
      {% if block.settings.body != blank %}
        <div class="ai-faq-body-{{ ai_gen_id }}">{{ block.settings.body }}</div>
      {% endif %}
    </div><div class="ai-faq-questions-{{ ai_gen_id }}">
      {% for i in (1..6) %}
        {% assign question_key = 'question_' | append: i %}
        {% assign answer_key = 'answer_' | append: i %}
        {% assign question = block.settings[question_key] %}
        {% assign answer = block.settings[answer_key] %}
        {% if question != blank and answer != blank %}
          <div class="ai-faq-item-{{ ai_gen_id }}" data-faq-item="{{ i }}">
            <button
              class="ai-faq-question-button-{{ ai_gen_id }}"
              aria-expanded="false"
              aria-controls="ai-faq-answer-{{ ai_gen_id }}-{{ i }}"
            >
              <span class="ai-faq-question-text-{{ ai_gen_id }}">{{ question }}</span>
              <svg class="ai-faq-icon-{{ ai_gen_id }}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"></polyline>
              </svg>
            </button>
            <div 
              class="ai-faq-answer-{{ ai_gen_id }}"
              id="ai-faq-answer-{{ ai_gen_id }}-{{ i }}"
              aria-hidden="true"
            >
              <div class="ai-faq-answer-content-{{ ai_gen_id }}">{{ answer }}</div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </faq-section-{{ ai_gen_id }}>
</section>

<script>
  (function() {
    class FaqSection{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.setupEventListeners();
      }

      setupEventListeners() {
        const faqItems = this.querySelectorAll('.ai-faq-item-{{ ai_gen_id }}');
        
        faqItems.forEach(item => {
          const button = item.querySelector('.ai-faq-question-button-{{ ai_gen_id }}');
          const answer = item.querySelector('.ai-faq-answer-{{ ai_gen_id }}');
          
          button.addEventListener('click', () => {
            const isActive = item.classList.contains('active');
            
            if (isActive) {
              this.closeItem(item, button, answer);
            } else {
              this.openItem(item, button, answer);
            }
          });
        });
      }

      openItem(item, button, answer) {
        item.classList.add('active');
        button.setAttribute('aria-expanded', 'true');
        answer.setAttribute('aria-hidden', 'false');
      }

      closeItem(item, button, answer) {
        item.classList.remove('active');
        button.setAttribute('aria-expanded', 'false');
        answer.setAttribute('aria-hidden', 'true');
      }
    }

    customElements.define('faq-section-{{ ai_gen_id }}', FaqSection{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "FAQ section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "FAQ"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "body",
      "label": "Body text",
      "default": "<p>Find answers to the most common questions about our products and services.</p>"
    },
    {
      "type": "header",
      "content": "Questions"
    },
    {
      "type": "text",
      "id": "question_1",
      "label": "Question 1",
      "default": "What is your return policy?"
    },
    {
      "type": "richtext",
      "id": "answer_1",
      "label": "Answer 1",
      "default": "<p>We offer a 30-day return policy for all unused items in their original packaging.</p>"
    },
    {
      "type": "text",
      "id": "question_2",
      "label": "Question 2",
      "default": "How long does shipping take?"
    },
    {
      "type": "richtext",
      "id": "answer_2",
      "label": "Answer 2",
      "default": "<p>Standard shipping takes 3-5 business days. Express shipping is available for 1-2 business days.</p>"
    },
    {
      "type": "text",
      "id": "question_3",
      "label": "Question 3",
      "default": "Do you offer international shipping?"
    },
    {
      "type": "richtext",
      "id": "answer_3",
      "label": "Answer 3",
      "default": "<p>Yes, we ship to most countries worldwide. Shipping costs and delivery times vary by location.</p>"
    },
    {
      "type": "text",
      "id": "question_4",
      "label": "Question 4"
    },
    {
      "type": "richtext",
      "id": "answer_4",
      "label": "Answer 4"
    },
    {
      "type": "text",
      "id": "question_5",
      "label": "Question 5"
    },
    {
      "type": "richtext",
      "id": "answer_5",
      "label": "Answer 5"
    },
    {
      "type": "text",
      "id": "question_6",
      "label": "Question 6"
    },
    {
      "type": "richtext",
      "id": "answer_6",
      "label": "Answer 6"
    },
    {
      "type": "header",
      "content": "Section background"
    },
    {
      "type": "image_picker",
      "id": "section_background_image",
      "label": "Background image"
    },
    {
      "type": "color",
      "id": "section_background_color",
      "label": "Background color",
      "default": "#f8f8f8"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 0
    },
    {
      "type": "header",
      "content": "Container background"
    },
    {
      "type": "image_picker",
      "id": "container_background_image",
      "label": "Container background image"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Container background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "container_overlay_color",
      "label": "Container overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "container_overlay_opacity",
      "label": "Container overlay opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 0
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "section_padding",
      "label": "Section padding",
      "min": 20,
      "max": 80,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "section_gap",
      "label": "Gap between content and questions",
      "min": 20,
      "max": 80,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_gap",
      "label": "Mobile gap",
      "min": 15,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 30
    },
    {
      "type": "select",
      "id": "mobile_text_alignment",
      "label": "Mobile text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "question_gap",
      "label": "Gap between questions",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "question_padding",
      "label": "Question padding",
      "min": 10,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "answer_padding",
      "label": "Answer padding",
      "min": 10,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Section border radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 8
    },
    {
      "type": "text",
      "id": "question_border_radius_custom",
      "label": "Question border radius",
      "default": "6,6,6,6",
      "info": "Enter values separated by commas: top-left, top-right, bottom-right, bottom-left (e.g., 16,8,16,8)"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "body_color",
      "label": "Body text",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "question_background",
      "label": "Question background",
      "default": "#f8f8f8"
    },
    {
      "type": "color",
      "id": "question_color",
      "label": "Question text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "question_border_color",
      "label": "Question border",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "answer_background",
      "label": "Answer background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "answer_color",
      "label": "Answer text",
      "default": "#555555"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "subheading_size",
      "label": "Subheading size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "heading_size",
      "label": "Heading size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 36
    },
    {
      "type": "range",
      "id": "body_size",
      "label": "Body text size",
      "min": 14,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "question_size",
      "label": "Question text size",
      "min": 14,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "answer_size",
      "label": "Answer text size",
      "min": 14,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 15
    }
  ],
  "presets": [
    {
      "name": "FAQ section"
    }
  ]
}
{% endschema %}